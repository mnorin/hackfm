#!/bin/bash
# fkeybar.class - Function key bar (MC style) using ba.sh

__FKEYBAR___properties=()

__FKEYBAR__.property(){
    # Property indices
    local row=0
    local width=1
    
    if [ "$2" = "=" ]; then
        __FKEYBAR___properties[$1]="$3"
    else
        echo "${__FKEYBAR___properties[$1]}"
    fi
}

# Property accessors
__FKEYBAR__.row(){
    if [ "$1" = "=" ]; then
        __FKEYBAR__.property row = "$2"
    else
        __FKEYBAR__.property row
    fi
}

__FKEYBAR__.width(){
    if [ "$1" = "=" ]; then
        __FKEYBAR__.property width = "$2"
    else
        __FKEYBAR__.property width
    fi
}

# Key labels array (set via render method)
declare -ag __FKEYBAR___labels=()

# Render function key bar
# Usage: fkeybar.render "Help" "" "View" "Edit" "Copy" "Move" "Mkdir" "Delete" "" "Quit"
__FKEYBAR__.render(){
    local row=$(__FKEYBAR__.row)
    local width=$(__FKEYBAR__.width)
    
    # Labels passed as arguments (F1-F10)
    local labels=("$@")
    
    # Ensure we have 10 labels
    while [ ${#labels[@]} -lt 10 ]; do
        labels+=("")
    done
    
    tui.cursor.move $row 1
    
    # Calculate spacing
    local key_width=$((width / 10))
    
    for i in {0..9}; do
        local num=$((i + 1))
        local label="${labels[$i]}"
        
        # Print number: white on black with leading space
        tui.color.white
        tui.color.bg_black
        if [ $num -lt 10 ]; then
            printf " %s" "$num"
        else
            printf "%s" "$num"
        fi
        
        # Print label: black on cyan
        tui.color.black
        tui.color.bg_cyan
        printf "%-$((key_width - 2))s" "$label"
    done
    
    tui.color.reset
}
